<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบจัดตารางสอนแทน O-NET</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts: Sarabun -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;700&display=swap" rel="stylesheet">
    <!-- html2canvas library for exporting -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
        }
        /* Style the date picker icon */
        input[type="date"]::-webkit-calendar-picker-indicator {
            cursor: pointer;
            filter: invert(0.6) sepia(0.5) saturate(5) hue-rotate(200deg); /* Adjust color to match theme */
        }
        /* Style for the buttons - Updated */
        .action-button {
            @apply inline-flex items-center justify-center px-5 py-2.5 text-base font-medium text-center text-white rounded-lg shadow-md transition duration-150 ease-in-out focus:ring-4 focus:outline-none;
        }
        .export-button {
             @apply bg-green-600 hover:bg-green-700 focus:ring-green-300;
        }
        .share-button {
             @apply bg-blue-600 hover:bg-blue-700 focus:ring-blue-300; /* Keep blue for share */
        }
         /* Simple toast notification style */
        #toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: #fff;
            padding: 10px 20px;
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            z-index: 1000;
            max-width: 90%;
            text-align: center;
        }
        #toast.show {
            opacity: 1;
        }
        /* Ensure the date input itself is centered */
        #date-picker-container {
            display: flex;
            justify-content: center;
        }
        /* Style added in previous turn, ensuring it is present */
        input[type="date"] {
             @apply w-auto max-w-xs p-3 border border-slate-300 rounded-lg text-lg text-center shadow-sm focus:ring-indigo-500 focus:border-indigo-500;
        }
    </style>
</head>
<body class="bg-slate-100">

    <div class="min-h-screen p-4 md:p-8">
        <div class="max-w-4xl mx-auto bg-white p-6 md:p-8 rounded-2xl shadow-lg">
            <h1 class="text-3xl font-bold text-center text-indigo-800 mb-6">
                ระบบจัดตารางสอนแทน O-NET
            </h1>

            <div class="mb-8 text-center"> <!-- Added text-center here -->
                <label for="date-picker" class="block text-lg font-medium text-slate-700 mb-3">
                    กรุณาเลือกวันที่
                </label>
                 <!-- Wrapped input in a div for better centering control -->
                <div id="date-picker-container">
                    <input
                        type="date"
                        id="date-picker"
                        value="2025-11-10" <!-- Set default date -->
                </div>
            </div>

             <!-- Action Buttons - Updated Share Button -->
             <div class="flex flex-col sm:flex-row justify-center items-center space-y-3 sm:space-y-0 sm:space-x-4 mb-8">
                <button id="export-btn" class="action-button export-button w-full sm:w-auto">
                    <i class="fas fa-file-export mr-2"></i> Export ตารางสอน (JPG)
                </button>
                <button id="share-btn" class="action-button share-button w-full sm:w-auto">
                   <i class="fas fa-share-square mr-2"></i> แชร์รูปภาพ <!-- Changed Icon & Text -->
                </button>
            </div>

            <hr class="my-8" />

            <div id="schedule-results" class="space-y-6 bg-white p-1"> <!-- Added bg-white and p-1 for better capture -->
                <!-- Results will be rendered here by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Toast Notification Element -->
    <div id="toast">ข้อความแจ้งเตือน</div>

    <script>
        // --- DATABASE: O-NET Schedule ---
        const onetData = {
          "10/11/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "11/11/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "12/11/2568": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "13/11/2568": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "14/11/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "17/11/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "18/11/2568": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "19/11/2568": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "20/11/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "21/11/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "24/11/2568": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "25/11/2568": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "26/11/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "27/11/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "28/11/2568": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "01/12/2568": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "02/12/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "03/12/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "04/12/2568": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "08/12/2568": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "09/12/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "11/12/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "12/12/2568": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "15/12/2568": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "16/12/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "17/12/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "18/12/2568": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "19/12/2568": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "22/12/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "23/12/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "24/12/2568": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "25/12/2568": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "29/12/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "30/12/2568": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "31/12/2568": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "06/01/2569": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "07/01/2569": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "08/01/2569": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "09/01/2569": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "12/01/2569": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "13/01/2569": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "14/01/2569": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "15/01/2569": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "16/01/2569": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "20/01/2569": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "21/01/2569": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "22/01/2569": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "23/01/2569": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "26/01/2569": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ],
          "27/01/2569": [
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '12:30 - 15:30 น.' }
          ],
          "28/01/2569": [
            { periods: [1, 2, 3], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '12:30 - 15:30 น.' }
          ],
          "29/01/2569": [
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ป.6', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ป.6', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ม.3', teacher: 'ครูสายรุ้ง เรืองสุขสุด', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ม.3', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' }
          ],
          "30/01/2569": [
            { periods: [1, 2, 3], subject: 'ภาษาอังกฤษ', grade: 'ป.6', teacher: 'ครูอรุณลักษณ์ การกระสัง', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'คณิตศาสตร์', grade: 'ป.6', teacher: 'ครูอมรเทพ จันทร์ครบ', time: '12:30 - 15:30 น.' },
            { periods: [1, 2, 3], subject: 'วิทยาศาสตร์', grade: 'ม.3', teacher: 'ครูณัฐชนม์ วงศ์มา', time: '08:30 - 11:30 น.' },
            { periods: [4, 5, 6], subject: 'ภาษาไทย', grade: 'ม.3', teacher: 'ครูดำเนิน ว่าดี', time: '12:30 - 15:30 น.' }
          ]
        };

        // --- DATABASE: Teacher Data & Schedules ---
        const allTeacherData = [
          // --- ครูติว O-NET ---
          {
            name: 'ครูณัฐชนม์ วงศ์มา',
            type: 'tutor',
            canTeachGrades: ['ป.4', 'ป.5', 'ป.6', 'ม.1', 'ม.2', 'ม.3'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: 'วิทยาศาสตร์และเทคฯ', grade: 'ม.1' },
                { period: 2, subject: 'วิทยาศาสตร์และเทคฯ 6', grade: 'ป.6' },
                { period: 3, subject: 'วิทยาศาสตร์และเทคฯ 4', grade: 'ป.4' },
                { period: 4, subject: 'ซ่อมเสริม', grade: 'ป.5' },
                { period: 5, subject: 'วิทยาศาสตร์และเทคฯ', grade: 'ม.2' },
                { period: 6, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.5' }
              ],
              'วันอังคาร': [
                { period: 1, subject: 'วิทยาศาสตร์และเทคฯ 4', grade: 'ป.4' },
                { period: 2, subject: 'วิทยาศาสตร์และเทคฯ', grade: 'ม.2' },
                { period: 3, subject: 'วิทยาศาสตร์และเทคฯ 5', grade: 'ป.5' },
                { period: 4, subject: 'วิทยาศาสตร์และเทคฯ', grade: 'ม.1' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: null, grade: null }
              ],
              'วันพุธ': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'วิทยาศาสตร์และเทคฯ 6', grade: 'ป.6' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'วิทยาศาสตร์ฯ (เพิ่มเติม)', grade: 'ม.1' },
                { period: 5, subject: 'วิทยาศาสตร์และเทคฯ', grade: 'ม.3' },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: 'วิทยาศาสตร์และเทคฯ', grade: 'ม.3' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'สุขศึกษาและพลศึกษา 5', grade: 'ป.5' },
                { period: 4, subject: 'สุขศึกษาและพลศึกษา 4', grade: 'ป.4' },
                { period: 5, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.5' },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: 'วิทยาศาสตร์ฯ (เพิ่มเติม)', grade: 'ม.2' },
                { period: 2, subject: 'วิทยาศาสตร์ฯ (เพิ่มเติม)', grade: 'ม.3' },
                { period: 3, subject: 'วิทยาศาสตร์และเทคฯ 5', grade: 'ป.5' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'PLC', grade: null }
              ]
            }
          },
          {
            name: 'ครูดำเนิน ว่าดี',
            type: 'tutor',
            canTeachGrades: ['ป.4', 'ป.5', 'ป.6', 'ม.1', 'ม.2', 'ม.3'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: 'ภาษาไทย 6', grade: 'ป.6' },
                { period: 2, subject: 'ศิลปะ (ทัศนศิลป์)', grade: 'ม.3' },
                { period: 3, subject: 'ภาษาไทย', grade: 'ม.1' },
                { period: 4, subject: 'ภาษาไทย', grade: 'ม.2' },
                { period: 5, subject: 'ภาษาไทย', grade: 'ม.3' },
                { period: 6, subject: 'ศิลปะ (ดนตรี)', grade: 'ม.1' }
              ],
              'วันอังคาร': [
                { period: 1, subject: 'ภาษาไทย 6', grade: 'ป.6' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'ภาษาไทย', grade: 'ม.1' },
                { period: 4, subject: 'ภาษาไทย', grade: 'ม.3' },
                { period: 5, subject: 'ศิลปะ (ดนตรี)', grade: 'ม.3' },
                { period: 6, subject: 'แนะแนว', grade: 'ป.6' }
              ],
              'วันพุธ': [
                { period: 1, subject: 'ภาษาไทย', grade: 'ม.1' },
                { period: 2, subject: 'ภาษาไทย', grade: 'ม.3' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'ศิลปะ (ทัศนศิลป์)', grade: 'ม.2' },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: 'ภาษาไทย 6', grade: 'ป.6' },
                { period: 2, subject: 'ภาษาไทย', grade: 'ม.2' },
                { period: 3, subject: 'ศิลปะ (ดนตรี)', grade: 'ม.2' },
                { period: 4, subject: 'วิทยาการคำนวณ 6', grade: 'ป.6' },
                { period: 5, subject: 'ศิลปะ (ทัศนศิลป์)', grade: 'ม.1' },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: 'ภาษาไทย 6', grade: 'ป.6' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'ภาษาไทย', grade: 'ม.2' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'PLC', grade: null }
              ]
            }
          },
          {
            name: 'ครูอมรเทพ จันทร์ครบ',
            type: 'tutor',
            canTeachGrades: ['ป.4', 'ป.5', 'ป.6', 'ม.1', 'ม.2', 'ม.3'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'คณิตศาสตร์', grade: 'ม.1' },
                { period: 3, subject: 'คณิตศาสตร์', grade: 'ม.2' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'คณิตศาสตร์ 6', grade: 'ป.6' },
                { period: 6, subject: null, grade: null }
              ],
              'วันอังคาร': [
                { period: 1, subject: 'คณิตศาสตร์', grade: 'ม.2' },
                { period: 2, subject: 'คณิตศาสตร์', grade: 'ม.1' },
                { period: 3, subject: 'คณิตศาสตร์', grade: 'ม.3' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'คณิตศาสตร์ 6', grade: 'ป.6' },
                { period: 6, subject: null, grade: null }
              ],
              'วันพุธ': [
                { period: 1, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.6' },
                { period: 2, subject: 'คณิตศาสตร์', grade: 'ม.1' },
                { period: 3, subject: 'คณิตศาสตร์', grade: 'ม.3' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'คณิตศาสตร์ 6', grade: 'ป.6' },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: 'คณิตศาสตร์', grade: 'ม.2' },
                { period: 2, subject: 'คณิตศาสตร์', grade: 'ม.3' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: 'คณิตศาสตร์ (เพิ่มเติม)', grade: 'ม.1' },
                { period: 2, subject: 'คณิตศาสตร์ (เพิ่มเติม)', grade: 'ม.2' },
                { period: 3, subject: 'คณิตศาสตร์ (เพิ่มเติม)', grade: 'ม.3' },
                { period: 4, subject: 'วิทยาการคำนวณ', grade: 'ม.3' },
                { period: 5, subject: 'คณิตศาสตร์ 6', grade: 'ป.6' },
                { period: 6, subject: 'แนะแนว', grade: 'ม.3' }
              ]
            }
          },
          {
            name: 'ครูสายรุ้ง เรืองสุขสุด',
            type: 'tutor',
            canTeachGrades: ['ป.4', 'ป.5', 'ป.6', 'ม.1', 'ม.2', 'ม.3'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: 'อังกฤษพื้นฐาน', grade: 'ม.2' },
                { period: 2, subject: 'อังกฤษ (เพิ่มเติม)', grade: 'ม.2' },
                { period: 3, subject: 'อังกฤษ (เพิ่มเติม)', grade: 'ม.3' },
                { period: 4, subject: 'อังกฤษพื้นฐาน', grade: 'ม.1' },
                { period: 5, subject: 'อังกฤษเพิ่มเติม 3', grade: 'ป.3' },
                { period: 6, subject: null, grade: null }
              ],
              'วันอังคาร': [
                { period: 1, subject: 'อังกฤษพื้นฐาน', grade: 'ม.1' },
                { period: 2, subject: 'อังกฤษพื้นฐาน 3', grade: 'ป.3' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'อังกฤษพื้นฐาน', grade: 'ม.2' },
                { period: 5, subject: 'วิทยาการคำนวณ', grade: 'ม.1' },
                { period: 6, subject: null, grade: null }
              ],
              'วันพุธ': [
                { period: 1, subject: 'อังกฤษพื้นฐาน', grade: 'ม.3' },
                { period: 2, subject: 'อังกฤษพื้นฐาน', grade: 'ม.2' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'อังกฤษพื้นฐาน 3', grade: 'ป.3' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: 'อังกฤษพื้นฐาน 5', grade: 'ป.5' },
                { period: 2, subject: 'อังกฤษ (เพิ่มเติม)', grade: 'ม.1' },
                { period: 3, subject: 'อังกฤษพื้นฐาน', grade: 'ม.3' },
                { period: 4, subject: 'แนะแนว', grade: 'ม.1' },
                { period: 5, subject: 'อังกฤษพื้นฐาน 3', grade: 'ป.3' },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: 'อังกฤษพื้นฐาน 5', grade: 'ป.5' },
                { period: 2, subject: 'อังกฤษพื้นฐาน 3', grade: 'ป.3' },
                { period: 3, subject: 'อังกฤษพื้นฐาน', grade: 'ม.1' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'อังกฤษพื้นฐาน', grade: 'ม.3' },
                { period: 6, subject: null, grade: null }
              ]
            }
          },
          {
            name: 'ครูอรุณลักษณ์ การกระสัง',
            type: 'tutor',
            canTeachGrades: ['ป.1', 'ป.2', 'ป.3', 'ป.4', 'ป.5', 'ป.6'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: 'อังกฤษพื้นฐาน 1', grade: 'ป.1' },
                { period: 2, subject: 'อังกฤษพื้นฐาน 4', grade: 'ป.4' },
                { period: 3, subject: 'อังกฤษเพิ่มเติม 6', grade: 'ป.6' },
                { period: 4, subject: 'อังกฤษพื้นฐาน 2', grade: 'ป.2' },
                { period: 5, subject: 'อังกฤษเพิ่มเติม 5', grade: 'ป.5' },
                { period: 6, subject: null, grade: null }
              ],
              'วันอังคาร': [
                { period: 1, subject: 'อังกฤษพื้นฐาน 2', grade: 'ป.2' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'อังกฤษพื้นฐาน 6', grade: 'ป.6' },
                { period: 4, subject: 'อังกฤษเพิ่มเติม 1', grade: 'ป.1' },
                { period: 5, subject: 'วิทยาการคำนวณ 4', grade: 'ป.4' },
                { period: 6, subject: null, grade: null }
              ],
              'วันพุธ': [
                { period: 1, subject: 'อังกฤษพื้นฐาน 1', grade: 'ป.1' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'อังกฤษพื้นฐาน 6', grade: 'ป.6' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'อังกฤษพื้นฐาน 2', grade: 'ป.2' },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'อังกฤษพื้นฐาน 4', grade: 'ป.4' },
                { period: 3, subject: 'อังกฤษพื้นฐาน 2', grade: 'ป.2' },
                { period: 4, subject: 'อังกฤษพื้นฐาน 1', grade: 'ป.1' },
                { period: 5, subject: 'ซ่อมเสริม', grade: 'ป.4' },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: 'อังกฤษเพิ่มเติม 2', grade: 'ป.2' },
                { period: 2, subject: 'อังกฤษเพิ่มเติม 4', grade: 'ป.4' },
                { period: 3, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.6' },
                { period: 4, subject: 'แนะแนว', grade: 'ป.4' },
                { period: 5, subject: 'อังกฤษพื้นฐาน 1', grade: 'ป.1' },
                { period: 6, subject: 'PLC', grade: null }
              ]
            }
          },

          // --- ครูทั่วไป ---
          {
            name: 'ครูวิภาวัลย์ นันท์มนัส',
            type: 'general',
            canTeachGrades: ['ป.1'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'คณิตศาสตร์ 1', grade: 'ป.1' },
                { period: 4, subject: 'แนะแนว', grade: 'ป.1' },
                { period: 5, subject: 'ภาษาไทย 1', grade: 'ป.1' },
                { period: 6, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.1' }
              ],
              'วันอังคาร': [
                { period: 1, subject: 'คณิตศาสตร์ 1', grade: 'ป.1' },
                { period: 2, subject: 'วิทยาศาสตร์และเทคฯ 1', grade: 'ป.1' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.1' },
                { period: 6, subject: 'ภาษาไทย 1', grade: 'ป.1' }
              ],
              'วันพุธ': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'คณิตศาสตร์ 1', grade: 'ป.1' },
                { period: 3, subject: 'ภาษาไทย 1', grade: 'ป.1' },
                { period: 4, subject: 'ซ่อมเสริม', grade: 'ป.1' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'ภาษาไทย 1', grade: 'ป.1' },
                { period: 3, subject: 'คณิตศาสตร์ 1', grade: 'ป.1' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'วิทยาการคำนวณ 1', grade: 'ป.1' },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'คณิตศาสตร์ 1', grade: 'ป.1' },
                { period: 3, subject: 'ภาษาไทย 1', grade: 'ป.1' },
                { period: 4, subject: 'ป้องกันการทุจริต 1', grade: 'ป.1' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'PLC', grade: null }
              ]
            }
          },
          {
            name: 'ครูวิภารักษ์ อักโข',
            type: 'general',
            canTeachGrades: ['ป.2'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: 'คณิตศาสตร์ 2', grade: 'ป.2' },
                { period: 2, subject: 'ภาษาไทย 2', grade: 'ป.2' },
                { period: 3, subject: 'วิทยาศาสตร์และเทคฯ 2', grade: 'ป.2' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'แนะแนว', grade: 'ป.2' },
                { period: 6, subject: 'วิทยาการคำนวณ 2', grade: 'ป.2' }
              ],
              'วันอังคาร': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'คณิตศาสตร์ 2', grade: 'ป.2' },
                { period: 3, subject: 'ภาษาไทย 2', grade: 'ป.2' },
                { period: 4, subject: 'ซ่อมเสริม', grade: 'ป.2' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.2' }
              ],
              'วันพุธ': [
                { period: 1, subject: 'ภาษาไทย 2', grade: 'ป.2' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'คณิตศาสตร์ 2', grade: 'ป.2' },
                { period: 4, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.2' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: 'คณิตศาสตร์ 2', grade: 'ป.2' },
                { period: 2, subject: 'ภาษาไทย 2', grade: 'ป.2' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'คณิตศาสตร์ 2', grade: 'ป.2' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'ป้องกันการทุจริต 2', grade: 'ป.2' },
                { period: 5, subject: 'ภาษาไทย 2', grade: 'ป.2' },
                { period: 6, subject: 'PLC', grade: null }
              ]
            }
          },
          {
            name: 'ครูวิไลพร ดอกแก้ว',
            type: 'general',
            canTeachGrades: ['ป.3'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: 'แนะแนว', grade: 'ป.3' },
                { period: 2, subject: 'คณิตศาสตร์ 3', grade: 'ป.3' },
                { period: 3, subject: 'ภาษาไทย 3', grade: 'ป.3' },
                { period: 4, subject: 'วิทยาศาสตร์และเทคฯ 3', grade: 'ป.3' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: null, grade: null }
              ],
              'วันอังคาร': [
                { period: 1, subject: 'ภาษาไทย 3', grade: 'ป.3' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'คณิตศาสตร์ 3', grade: 'ป.3' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.3' },
                { period: 6, subject: 'ซ่อมเสริม', grade: 'ป.3' }
              ],
              'วันพุธ': [
                { period: 1, subject: 'คณิตศาสตร์ 3', grade: 'ป.3' },
                { period: 2, subject: 'ภาษาไทย 3', grade: 'ป.3' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'วิทยาการคำนวณ 3', grade: 'ป.3' },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: 'ภาษาไทย 3', grade: 'ป.3' },
                { period: 2, subject: 'คณิตศาสตร์ 3', grade: 'ป.3' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.3' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: 'ภาษาไทย 3', grade: 'ป.3' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'คณิตศาสตร์ 3', grade: 'ป.3' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'ป้องการทุจริต 3', grade: 'ป.3' },
                { period: 6, subject: 'PLC', grade: null }
              ]
            }
          },
          {
            name: 'ครูพจนาจ หวลระลึก',
            type: 'general',
            canTeachGrades: ['ป.1', 'ป.2', 'ป.3', 'ป.4', 'ป.5', 'ป.6'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'ศิลปะ (ดนตรี) 6', grade: 'ป.6' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ศิลปะ 3', grade: 'ป.3' }
              ],
              'วันอังคาร': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'การงานอาชีพ 1', grade: 'ป.1' },
                { period: 4, subject: 'ประวัติศาสตร์ 3', grade: 'ป.3' },
                { period: 5, subject: 'การงานอาชีพ 2', grade: 'ป.2' },
                { period: 6, subject: 'ศิลปะ (ดนตรี) 5', grade: 'ป.5' }
              ],
              'วันพุธ': [
                { period: 1, subject: 'ศิลปะ (ดนตรี) 4', grade: 'ป.4' },
                { period: 2, subject: 'ศิลปะ (ทัศนศิลป์) 5', grade: 'ป.5' },
                { period: 3, subject: 'สังคมศึกษาฯ 3', grade: 'ป.3' },
                { period: 4, subject: 'ศิลปะ (ทัศนศิลป์) 4', grade: 'ป.4' },
                { period: 5, subject: 'ศิลปะ 1', grade: 'ป.1' },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: 'สุขศึกษาและพลศึกษา 1', grade: 'ป.1' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'สุขศึกษาและพลศึกษา 3', grade: 'ป.3' },
                { period: 4, subject: 'สุขศึกษาและพลศึกษา 2', grade: 'ป.2' },
                { period: 5, subject: 'ศิลปะ 2', grade: 'ป.2' },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: 'สังคมศึกษาฯ 1', grade: 'ป.1' },
                { period: 2, subject: 'ศิลปะ (ทัศนศิลป์) 6', grade: 'ป.6' },
                { period: 3, subject: 'สังคมศึกษาฯ 2', grade: 'ป.2' },
                { period: 4, subject: 'การงานอาชีพ 3', grade: 'ป.3' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'PLC', grade: null }
              ]
            }
          },
          {
            name: 'ครูวิไลวรรณ ทองคำ',
            type: 'general',
            canTeachGrades: ['ป.1', 'ป.2', 'ป.3', 'ป.4', 'ป.5', 'ป.6'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: 'สังคมศึกษาฯ 5', grade: 'ป.5' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'ภาษาไทย 5', grade: 'ป.5' },
                { period: 4, subject: 'ภาษาไทย 4', grade: 'ป.4' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ประวัติศาสตร์ 6', grade: 'ป.6' }
              ],
              'วันอังคาร': [
                { period: 1, subject: 'ภาษาไทย 5', grade: 'ป.5' },
                { period: 2, subject: 'ประวัติศาสตร์ 4', grade: 'ป.4' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'สังคมศึกษาฯ 6', grade: 'ป.6' },
                { period: 5, subject: 'ป้องกันการทุจริต 5', grade: 'ป.5' },
                { period: 6, subject: 'สังคมศึกษาฯ 4', grade: 'ป.4' }
              ],
              'วันพุธ': [
                { period: 1, subject: 'ภาษาไทย 5', grade: 'ป.5' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'ภาษาไทย 4', grade: 'ป.4' },
                { period: 4, subject: 'สังคมศึกษาฯ 5', grade: 'ป.5' },
                { period: 5, subject: 'ป้องกันการทุจริต 4', grade: 'ป.4' },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'สังคมศึกษาฯ 6', grade: 'ป.6' },
                { period: 3, subject: 'ภาษาไทย 4', grade: 'ป.4' },
                { period: 4, subject: 'วิทยาการคำนวณ 5', grade: 'ป.5' },
                { period: 5, subject: 'ป้องกันการทุจริต 6', grade: 'ป.6' },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: 'สังคมศึกษาฯ 4', grade: 'ป.4' },
                { period: 2, subject: 'ภาษาไทย 5', grade: 'ป.5' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'ประวัติศาสตร์ 5', grade: 'ป.5' },
                { period: 5, subject: 'ภาษาไทย 4', grade: 'ป.4' },
                { period: 6, subject: 'PLC', grade: null }
              ]
            }
          },
          {
            name: 'ครูบรรจง หวังทรัพย์',
            type: 'general',
            canTeachGrades: ['ป.4', 'ป.5', 'ป.6', 'ม.1', 'ม.2', 'ม.3'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'ประวัติศาสตร์ 1', grade: 'ป.1' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'การงานอาชีพ (เพิ่มเติม)', grade: 'ม.3' },
                { period: 5, subject: 'การงานอาชีพ 4', grade: 'ป.4' },
                { period: 6, subject: 'การงานอาชีพ', grade: 'ม.2' }
              ],
              'วันอังคาร': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'การงานอาชีพ 6', grade: 'ป.6' },
                { period: 3, subject: 'การงานอาชีพ', grade: 'ม.2' },
                { period: 4, subject: 'การงานอาชีพ 5', grade: 'ป.5' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'การงานอาชีพ', grade: 'ม.3' }
              ],
              'วันพุธ': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'ประวัติศาสตร์ 2', grade: 'ป.2' },
                { period: 3, subject: 'การงานอาชีพ', grade: 'ม.1' },
                { period: 4, subject: 'การงานอาชีพ', grade: 'ม.3' },
                { period: 5, subject: 'การงานอาชีพ 5', grade: 'ป.5' },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: 'การงานอาชีพ 4', grade: 'ป.4' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'พลศึกษา', grade: 'ม.1' },
                { period: 4, subject: 'พลศึกษา', grade: 'ม.3' },
                { period: 5, subject: 'พลศึกษา', grade: 'ม.2' },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'การงานอาชีพ', grade: 'ม.1' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'การงานอาชีพ 6', grade: 'ป.6' },
                { period: 5, subject: 'การงานอาชีพ (เพิ่มเติม)', grade: 'ม.2' },
                { period: 6, subject: 'การงานอาชีพ (เพิ่มเติม)', grade: 'ม.1' }
              ]
            }
          },
          {
            name: 'ครูเอกพจน์ หัวเขา',
            type: 'general',
            canTeachGrades: ['ป.4', 'ป.5', 'ป.6', 'ม.1', 'ม.2', 'ม.3'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: 'สังคมศึกษาฯ', grade: 'ม.3' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'สังคมศึกษาฯ', grade: 'ม.1' },
                { period: 6, subject: 'ป้องกันการทุจริต', grade: 'ม.3' }
              ],
              'วันอังคาร': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'สังคมศึกษาฯ', grade: 'ม.3' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'สังคมศึกษาฯ', grade: 'ม.2' }
              ],
              'วันพุธ': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'สังคมศึกษาฯ', grade: 'ม.2' },
                { period: 4, subject: 'ป้องกันการทุจริต', grade: 'ม.2' },
                { period: 5, subject: 'สังคมศึกษาฯ', grade: 'ม.1' },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: 'ประวัติศาสตร์', grade: 'ม.1' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'ประวัติศาสตร์', grade: 'ม.2' },
                { period: 5, subject: 'ประวัติศาสตร์', grade: 'ม.3' },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: 'สังคมศึกษาฯ', grade: 'ม.3' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'สังคมศึกษาฯ', grade: 'ม.2' },
                { period: 4, subject: 'สังคมศึกษาฯ', grade: 'ม.1' },
                { period: 5, subject: 'ป้องกันการทุจริต', grade: 'ม.1' },
                { period: 6, subject: 'แนะแนว', grade: 'ม.2' }
              ]
            }
          },
          {
            name: 'ครูกฤติยา ศรีเพชร',
            type: 'general',
            canTeachGrades: ['ป.4', 'ป.5', 'ป.6', 'ม.1', 'ม.2', 'ม.3'],
            canTeachSpecial: null,
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: 'คณิตศาสตร์ 4', grade: 'ป.4' },
                { period: 2, subject: 'คณิตศาสตร์ 5', grade: 'ป.5' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.4' }
              ],
              'วันอังคาร': [
                { period: 1, subject: 'สุขศึกษา', grade: 'ม.3' },
                { period: 2, subject: 'คณิตศาสตร์ 5', grade: 'ป.5' },
                { period: 3, subject: 'คณิตศาสตร์ 4', grade: 'ป.4' },
                { period: 4, subject: 'วางทุกงานอ่านทุกคน', grade: 'ป.4' },
                { period: 5, subject: 'วิทยาการคำนวณ', grade: 'ม.2' },
                { period: 6, subject: 'สุขศึกษา', grade: 'ม.1' }
              ],
              'วันพุธ': [
                { period: 1, subject: 'สุขศึกษา', grade: 'ม.2' },
                { period: 2, subject: 'คณิตศาสตร์ 4', grade: 'ป.4' },
                { period: 3, subject: 'คณิตศาสตร์ 5', grade: 'ป.5' },
                { period: 4, subject: 'ซ่อมเสริม', grade: 'ป.6' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: 'คณิตศาสตร์ 5', grade: 'ป.5' },
                { period: 3, subject: 'สุขศึกษาและพลศึกษา 6', grade: 'ป.6' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: null, grade: null },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'คณิตศาสตร์ 4', grade: 'ป.4' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'แนะแนว', grade: 'ป.5' },
                { period: 6, subject: null, grade: null }
              ]
            }
          },
          {
            name: 'ครูคีร่า โอคอนเนล',
            type: 'general',
            canTeachGrades: [], // สอนเฉพาะอังกฤษ
            canTeachSpecial: { subject: 'อังกฤษ', grades: ['ป.1', 'ป.2', 'ป.3', 'ป.4', 'ป.5', 'ป.6', 'ม.1', 'ม.2', 'ม.3'] },
            schedule: {
              'วันจันทร์': [
                { period: 1, subject: 'อังกฤษพื้นฐาน', grade: 'ม.2' },
                { period: 2, subject: 'อังกฤษพื้นฐาน 4', grade: 'ป.4' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: 'อังกฤษพื้นฐาน 2', grade: 'ป.2' },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: null, grade: null }
              ],
              'วันอังคาร': [
                { period: 1, subject: 'อังกฤษพื้นฐาน', grade: 'ม.1' },
                { period: 2, subject: 'อังกฤษพื้นฐาน 3', grade: 'ป.3' },
                { period: 3, subject: 'อังกฤษพื้นฐาน 6', grade: 'ป.6' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: null, grade: null }
              ],
              'วันพุธ': [
                { period: 1, subject: 'อังกฤษพื้นฐาน 1', grade: 'ป.1' },
                { period: 2, subject: null, grade: null },
                { period: 3, subject: 'อังกฤษพื้นฐาน 6', grade: 'ป.6' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'อังกฤษพื้นฐาน 2', grade: 'ป.2' },
                { period: 6, subject: 'ลูกเสือ', grade: null }
              ],
              'วันพฤหัสบดี': [
                { period: 1, subject: 'อังกฤษพื้นฐาน 5', grade: 'ป.5' },
                { period: 2, subject: 'อังกฤษพื้นฐาน 4', grade: 'ป.4' },
                { period: 3, subject: 'อังกฤษพื้นฐาน', grade: 'ม.3' },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: null, grade: null },
                { period: 6, subject: 'ชุมนุม', grade: null }
              ],
              'วันศุกร์': [
                { period: 1, subject: 'อังกฤษพื้นฐาน 5', grade: 'ป.5' },
                { period: 2, subject: 'อังกฤษพื้นฐาน 3', grade: 'ป.3' },
                { period: 3, subject: null, grade: null },
                { period: 4, subject: null, grade: null },
                { period: 5, subject: 'อังกฤษพื้นฐาน 1', grade: 'ป.1' },
                { period: 6, subject: 'PLC', grade: null }
              ]
            }
          }
        ];

        // --- HELPER FUNCTIONS ---

        const EXCLUDED_SUBJECTS = ['ลูกเสือ', 'ชุมนุม', 'PLC'];
        const TUTORING_GRADES = ['ป.6', 'ม.3'];

        function formatDateToKey(dateString) {
          if (!dateString) return null;
          const [year, month, day] = dateString.split('-');
          const buddhistYear = parseInt(year) + 543;
          return `${day}/${month}/${buddhistYear}`;
        }

        function getDayOfWeek(dateKey) {
          if (!dateKey) return null;
          const [day, month, year] = dateKey.split('/');
          const gregorianYear = parseInt(year) - 543;
          const date = new Date(`${gregorianYear}-${month}-${day}`);
          const dayIndex = date.getDay();
          const days = ['วันอาทิตย์', 'วันจันทร์', 'วันอังคาร', 'วันพุธ', 'วันพฤหัสบดี', 'วันศุกร์', 'วันเสาร์'];
          return days[dayIndex];
        }

        function canTeacherSubstitute(teacher, targetGrade, targetSubject) {
            if (!targetGrade) return true;

            // Handle special subject teacher (e.g., English only)
            if (teacher.canTeachSpecial) {
                const { subject, grades } = teacher.canTeachSpecial;
                // Use includes for broader subject matching (e.g., "อังกฤษพื้นฐาน" includes "อังกฤษ")
                if (targetSubject.toLowerCase().includes(subject.toLowerCase())) {
                    if (grades.includes(targetGrade)) {
                        return true;
                    }
                }
            }

            // Handle general grade teacher
            if (teacher.canTeachGrades.includes(targetGrade)) {
                return true;
            }

            // If subject-specific and didn't match, or general and didn't match
            return false;
        }


        function isGradeTutoring(grade, period, onetDaySchedule) {
          // Checks if a specific grade is in O-NET tutoring at a specific period
          if (!TUTORING_GRADES.includes(grade) || !onetDaySchedule) {
            return false;
          }
          for (const session of onetDaySchedule) {
            if (session.grade === grade && session.periods.includes(period)) {
              return true;
            }
          }
          return false;
        }

        function isTeacherTutoring(teacherName, period, onetDaySchedule) {
            // Checks if a specific teacher is busy tutoring O-NET at a specific period
            if (!onetDaySchedule) {
                return false;
            }
            for (const session of onetDaySchedule) {
                if (session.teacher === teacherName && session.periods.includes(period)) {
                    return true;
                }
            }
            return false;
        }

        // --- CORE SUBSTITUTION LOGIC ---

        function generateSubstituteSchedule(dateKey) {
            const onetDaySchedule = onetData[dateKey];
            const dayOfWeek = getDayOfWeek(dateKey);

            if (!onetDaySchedule || !dayOfWeek) {
                return { schedule: [], fullDateText: '', dayOfWeekText: dayOfWeek || '' }; // No O-NET on this day
            }

             // Calculate fullDateText and dayOfWeekText here
            const [day, monthIndex, year] = dateKey.split('/');
            const thaiMonths = [
                'มกราคม', 'กุมภาพันธ์', 'มีนาคม', 'เมษายน', 'พฤษภาคม', 'มิถุนายน',
                'กรกฎาคม', 'สิงหาคม', 'กันยายน', 'ตุลาคม', 'พฤศจิกายน', 'ธันวาคม'
            ];
            const fullDateText = `วันที่ ${parseInt(day)} ${thaiMonths[parseInt(monthIndex) - 1]} ${year}`;
            const dayOfWeekText = dayOfWeek;


            // 1. Initialize teacher workloads
            const teacherWorkloads = {};

            allTeacherData.forEach(teacher => {
                let baseWorkload = 0;
                const normalSchedule = teacher.schedule[dayOfWeek];
                if (normalSchedule) {
                    normalSchedule.forEach(cls => {
                        // Count as workload if it's a real subject
                        if (cls.subject && !EXCLUDED_SUBJECTS.includes(cls.subject)) {
                            // AND if the grade isn't away for O-NET tutoring at that time
                            if (!isGradeTutoring(cls.grade, cls.period, onetDaySchedule)) {
                                // *** CORRECTED LOGIC ***
                                // AND if the teacher themself is NOT busy tutoring O-NET at this exact time
                                // (If they are tutoring, this class is a "class to be covered" and not part of their base workload)
                                if (!isTeacherTutoring(teacher.name, cls.period, onetDaySchedule)) {
                                    baseWorkload++;
                                }
                            }
                        }
                    });
                }
                teacherWorkloads[teacher.name] = { base: baseWorkload, onet: 0, sub: 0, total: baseWorkload };
            });

            // 2. Add O-NET tutoring workload
            onetDaySchedule.forEach(session => {
                const tutorName = session.teacher;
                if (teacherWorkloads[tutorName]) {
                    const onetHours = session.periods.length;
                    teacherWorkloads[tutorName].onet = onetHours;
                    teacherWorkloads[tutorName].total += onetHours;
                } else {
                    console.warn(`O-NET tutor not found in teacher database: ${tutorName}`);
                }
            });

            // 3. Find and assign substitutes
            const finalSchedule = [];
            const substitutionsMade = {}; // Tracks { period: [teacherName, ...], ... }

            for (const session of onetDaySchedule) {
                const tutorName = session.teacher;
                const tutor = allTeacherData.find(t => t.name === tutorName);
                const onetPeriods = session.periods; // e.g., [1, 2, 3]

                if (!tutor) continue;

                const scheduleEntry = {
                    tutorName: tutor.name,
                    reason: `ติดติว O-NET ${session.subject} ${session.grade} เวลา ${session.time}`,
                    substitutions: []
                };

                const tutorNormalSchedule = tutor.schedule[dayOfWeek];

                // Find classes the tutor is missing *because* of O-NET
                for (const classToCover of tutorNormalSchedule) {
                    const period = classToCover.period;

                    // A. Must be a class during the O-NET session
                    if (!onetPeriods.includes(period)) continue;

                    // B. Must be a real subject (not excluded)
                    if (!classToCover.subject || EXCLUDED_SUBJECTS.includes(classToCover.subject)) continue;

                    // C. Must not be a class where students are also at O-NET (auto-exempted)
                    if (isGradeTutoring(classToCover.grade, period, onetDaySchedule)) continue;

                    // --- Find a substitute for this specific class ---
                    let candidates = [];
                    for (const potentialSub of allTeacherData) {
                        // 1. Can't substitute for themselves
                        if (potentialSub.name === tutorName) continue;

                        // 2. Check if the potential sub is TRULY vacant at this period
                        const subSchedule = potentialSub.schedule[dayOfWeek].find(s => s.period === period);
                        let isVacant = false;

                        // 2a. Vacant if they have no class or an excluded class
                        if (!subSchedule || !subSchedule.subject || EXCLUDED_SUBJECTS.includes(subSchedule.subject)) {
                            isVacant = true;
                        } 
                        // 2b. Also vacant if their normal class's students (P.6/M.3) are at O-NET
                        else if (isGradeTutoring(subSchedule.grade, period, onetDaySchedule)) {
                             isVacant = true;
                        }

                        // 2c. BUT, they are NOT vacant if they are *also* an O-NET tutor and tutoring *this* period
                        if (isTeacherTutoring(potentialSub.name, period, onetDaySchedule)) {
                            isVacant = false; // Overrule: They are busy tutoring O-NET
                        }

                        // 2d. NOT vacant if they have *already* been assigned a sub class this period
                        if (substitutionsMade[period] && substitutionsMade[period].includes(potentialSub.name)) {
                            isVacant = false;
                        }

                        // 3. If not vacant, skip them
                        if (!isVacant) continue;

                        // 4. Check if they are qualified to teach this class
                        if (!canTeacherSubstitute(potentialSub, classToCover.grade, classToCover.subject)) {
                            continue;
                        }

                        // 5. If all checks pass, they are a candidate
                        candidates.push({
                            name: potentialSub.name,
                            currentWorkload: teacherWorkloads[potentialSub.name].total
                        });
                    }

                    // --- Assign the best candidate ---
                    if (candidates.length > 0) {
                        // Sort by lowest workload first
                        candidates.sort((a, b) => a.currentWorkload - b.currentWorkload);
                        
                        const bestSubName = candidates[0].name;
                        const newWorkload = candidates[0].currentWorkload + 1;

                        scheduleEntry.substitutions.push({
                            period: period,
                            classInfo: `${classToCover.grade || 'ไม่ระบุ'}/${classToCover.subject}`,
                            subTeacher: bestSubName,
                            reason: `ครูว่าง (คาบรวมน้อยสุด), คาบรวม=${newWorkload}`
                        });

                        // Update workload and mark as assigned
                        teacherWorkloads[bestSubName].sub++;
                        teacherWorkloads[bestSubName].total++;

                        if (!substitutionsMade[period]) {
                            substitutionsMade[period] = [];
                        }
                        substitutionsMade[period].push(bestSubName);

                    } else {
                        // No candidates found
                        scheduleEntry.substitutions.push({
                            period: period,
                            classInfo: `${classToCover.grade || 'ไม่ระบุ'}/${classToCover.subject}`,
                            subTeacher: null,
                            reason: 'หาคนสอนแทนไม่ได้'
                        });
                    }
                }

                // Only add to final schedule if there was at least one class to cover
                if (scheduleEntry.substitutions.length > 0) {
                    finalSchedule.push(scheduleEntry);
                }
            }

             return { schedule: finalSchedule, fullDateText, dayOfWeekText };
        }

        // --- UI Rendering ---

        const datePicker = document.getElementById('date-picker');
        const resultsDiv = document.getElementById('schedule-results');
        const exportBtn = document.getElementById('export-btn');
        const shareBtn = document.getElementById('share-btn');
        const toast = document.getElementById('toast');
        let toastTimeout;


        function showToast(message) {
            toast.textContent = message;
            toast.classList.add('show');
            clearTimeout(toastTimeout); // Clear previous timeout if any
            toastTimeout = setTimeout(() => {
                toast.classList.remove('show');
            }, 3000); // Hide after 3 seconds
        }

        function renderSchedule() {
            const selectedDateValue = datePicker.value;
            const dateKey = formatDateToKey(selectedDateValue);
            const { schedule, fullDateText, dayOfWeekText } = generateSubstituteSchedule(dateKey);

            resultsDiv.innerHTML = ''; // Clear previous results

            // Create and append header for schedule results
            const header = document.createElement('h3');
            header.className = "text-2xl font-bold text-center text-indigo-700 mb-6";
            header.innerHTML = `📆 ผลการจัดตารางสอนแทน ${dayOfWeekText} ${fullDateText}`;


            if (schedule.length > 0) {
                resultsDiv.appendChild(header); // Append header only if there are results

                // Create schedule entries
                schedule.forEach(tutorEntry => {
                    const entryDiv = document.createElement('div');
                    entryDiv.className = "bg-slate-50 p-5 rounded-lg shadow-md border border-slate-200";

                    // Tutor name and reason
                    const tutorHeader = document.createElement('h4');
                    tutorHeader.className = "text-xl font-semibold text-indigo-900 mb-4";
                    tutorHeader.innerHTML = `สอนแทน ${tutorEntry.tutorName}
                        <span class="font-normal text-slate-700 text-base block md:inline md:ml-2">
                            (${tutorEntry.reason})
                        </span>`;
                    entryDiv.appendChild(tutorHeader);

                    // List of substitutions
                    const subList = document.createElement('ul');
                    subList.className = "list-disc list-inside space-y-3 pl-2";

                    tutorEntry.substitutions.forEach(sub => {
                        const listItem = document.createElement('li');
                        listItem.className = "text-slate-800 text-base md:text-lg";

                        let subTeacherHtml;
                        if (sub.subTeacher) {
                            subTeacherHtml = `<strong class="text-green-700 ml-1">${sub.subTeacher}</strong>`;
                        } else {
                            subTeacherHtml = `<strong class="text-red-600 ml-1">หาคนสอนแทนไม่ได้</strong>`;
                        }

                        listItem.innerHTML = `
                            <strong class="text-slate-900">คาบ ${sub.period}:</strong> ${sub.classInfo} →
                            ${subTeacherHtml}
                            <span class="text-sm text-slate-500 block md:inline md:ml-2">
                                (${sub.reason})
                            </span>`;
                        subList.appendChild(listItem);
                    });

                    entryDiv.appendChild(subList);
                    resultsDiv.appendChild(entryDiv);
                });
            } else {
                // No O-NET or no substitutions needed - Append header first
                 resultsDiv.appendChild(header); // Still show the date header
                 const noDataPara = document.createElement('p');
                noDataPara.className = "text-center text-slate-500 text-xl font-medium py-8";
                noDataPara.textContent = dayOfWeekText ? `ไม่มีการติว O-NET หรือไม่มีคาบสอนแทนในวันนี้` : "กรุณาเลือกวันที่ที่ถูกต้อง";
                resultsDiv.appendChild(noDataPara);
            }
        }

        // --- Event Listeners ---
        datePicker.addEventListener('change', renderSchedule);

        exportBtn.addEventListener('click', () => {
            const scheduleElement = document.getElementById('schedule-results');
            if (!scheduleElement || scheduleElement.children.length === 0 || scheduleElement.querySelector('p')) {
                showToast('ไม่มีตารางสอนให้ Export');
                return;
            }

            // Temporarily increase scale for higher resolution
            html2canvas(scheduleElement, {
                scale: 3, // Increase scale for better quality
                useCORS: true, // If using external fonts/images (though not applicable here)
                backgroundColor: '#ffffff' // Ensure background is white
             }).then(canvas => {
                const link = document.createElement('a');
                link.download = `ตารางสอนแทน-${datePicker.value}.jpg`;
                link.href = canvas.toDataURL('image/jpeg', 0.95); // Use JPEG format, quality 0.95
                link.click();
            }).catch(err => {
                 console.error("Error exporting image:", err);
                 showToast('เกิดข้อผิดพลาดในการ Export รูปภาพ');
            });
        });

        // Updated Share Button Logic
        shareBtn.addEventListener('click', async () => {
            const scheduleElement = document.getElementById('schedule-results');
            const dateValue = datePicker.value;

            if (!scheduleElement || scheduleElement.children.length === 0 || scheduleElement.querySelector('p')) {
                showToast('ไม่มีตารางสอนให้แชร์');
                return;
            }

            // Check if Web Share API is supported and can share files
            if (navigator.share && navigator.canShare) {
                try {
                    // Generate image from schedule element
                    const canvas = await html2canvas(scheduleElement, { scale: 2, backgroundColor: '#ffffff', useCORS: true });
                    canvas.toBlob(async (blob) => {
                        if (!blob) {
                            showToast('ไม่สามารถสร้างรูปภาพได้');
                            return;
                        }
                        const fileName = `ตารางสอนแทน-${dateValue}.jpg`;
                        const file = new File([blob], fileName, { type: 'image/jpeg' });
                        const shareData = {
                            files: [file],
                            title: `ตารางสอนแทนวันที่ ${dateValue}`,
                            text: `ตารางสอนแทนวันที่ ${dateValue}`,
                        };

                        // Check if the browser *can* share these files
                        if (navigator.canShare(shareData)) {
                            try {
                                await navigator.share(shareData);
                                console.log('Image shared successfully');
                            } catch (err) {
                                console.error('Share failed:', err.message);
                                // Fallback if sharing fails (e.g., user cancels)
                                showToast('การแชร์ถูกยกเลิก หรือ ไม่สำเร็จ');
                                // Optional: Suggest export as fallback here too?
                            }
                        } else {
                             console.warn('Cannot share files according to navigator.canShare');
                             showToast('เบราว์เซอร์ไม่รองรับการแชร์ไฟล์รูปภาพโดยตรง กรุณา Export แล้วแชร์ด้วยตนเอง');
                        }
                    }, 'image/jpeg', 0.95); // Convert to Blob

                } catch (err) {
                    console.error('Error generating or sharing image:', err);
                    showToast('เกิดข้อผิดพลาดในการแชร์รูปภาพ กรุณา Export แล้วแชร์ด้วยตนเอง');
                }
            } else {
                // Fallback for browsers that don't support Web Share API or file sharing
                showToast('เบราว์เซอร์ไม่รองรับการแชร์รูปภาพโดยตรง กรุณา Export แล้วแชร์ด้วยตนเอง');
            }
        });


        // Fallback copy function using document.execCommand (kept in case needed elsewhere, but not used by share image)
        function copyUsingExecCommand(text) {
             const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";  // Avoid scrolling to bottom
            textArea.style.top = "0";
            textArea.style.left = "0";
            textArea.style.opacity = "0"; // Make it invisible

            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();

            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showToast('คัดลอกลิงก์ไปยังคลิปบอร์ดแล้ว'); // Might need to change this text if used for other purposes
                } else {
                     showToast('ไม่สามารถคัดลอกได้');
                }
            } catch (err) {
                 console.error('Fallback: Oops, unable to copy', err);
                 showToast('ไม่สามารถคัดลอกได้');
            }

            document.body.removeChild(textArea);
        }

        // --- Initial Load ---
        // Run schedule generation on page load with the default date
        document.addEventListener('DOMContentLoaded', renderSchedule);

    </script>

</body>
</html>

